"use strict";(self.webpackChunkmemos=self.webpackChunkmemos||[]).push([[592],{3891:(Q,g,o)=>{o.d(g,{W:()=>U});var v=o(7394);class p extends v.w0{constructor(e,s){super()}schedule(e,s=0){return this}}const d={setInterval(n,e,...s){const{delegate:t}=d;return t?.setInterval?t.setInterval(n,e,...s):setInterval(n,e,...s)},clearInterval(n){const{delegate:e}=d;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var h=o(9039);const m={now:()=>(m.delegate||Date).now(),delegate:void 0};class l{constructor(e,s=l.now){this.schedulerActionCtor=e,this.now=s}schedule(e,s=0,t){return new this.schedulerActionCtor(this,e).schedule(t,s)}}l.now=m.now;const I=new class A extends l{constructor(e,s=l.now){super(e,s),this.actions=[],this._active=!1}flush(e){const{actions:s}=this;if(this._active)return void s.push(e);let t;this._active=!0;do{if(t=e.execute(e.state,e.delay))break}while(e=s.shift());if(this._active=!1,t){for(;e=s.shift();)e.unsubscribe();throw t}}}(class f extends p{constructor(e,s){super(e,s),this.scheduler=e,this.work=s,this.pending=!1}schedule(e,s=0){var t;if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,s)),this.pending=!0,this.delay=s,this.id=null!==(t=this.id)&&void 0!==t?t:this.requestAsyncId(r,this.id,s),this}requestAsyncId(e,s,t=0){return d.setInterval(e.flush.bind(e,this),t)}recycleAsyncId(e,s,t=0){if(null!=t&&this.delay===t&&!1===this.pending)return s;null!=s&&d.clearInterval(s)}execute(e,s){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const t=this._execute(e,s);if(t)return t;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,s){let i,t=!1;try{this.work(e)}catch(r){t=!0,i=r||new Error("Scheduled action threw falsy error")}if(t)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:s}=this,{actions:t}=s;this.work=this.state=this.scheduler=null,this.pending=!1,(0,h.P)(t,this),null!=e&&(this.id=this.recycleAsyncId(s,e,null)),this.delay=null,super.unsubscribe()}}}),P=I;var $=o(5592),T=o(671);function b(n=0,e,s=P){let t=-1;return null!=e&&((0,T.K)(e)?s=e:t=e),new $.y(i=>{let r=function M(n){return n instanceof Date&&!isNaN(n)}(n)?+n-s.now():n;r<0&&(r=0);let a=0;return s.schedule(function(){i.closed||(i.next(a++),0<=t?this.schedule(void 0,t):i.complete())},r)})}var q=o(9773),D=o(7398),F=o(6232),E=o(9360),S=o(8251),V=o(4829),y=o(5619),w=o(8645),C=o(4946),N=o(7382),H=o(8489);let U=(()=>{var n;class e{get repetitionModeActive(){return this.randomizer&&!this.sectionsVisible}get timer$(){return function R(n=0,e=I){return n<0&&(n=0),b(n,n,e)}(1e3).pipe((0,q.R)(this.stopTimer),(0,D.U)(t=>{const r=t%60,a={min:Math.floor(t/60).toString().padStart(2,"0"),sec:r.toString().padStart(2,"0")};return this.summaryService.addLearningTime(a),a}),function z(n){let s,e=1/0;return null!=n&&("object"==typeof n?({count:e=1/0,delay:s}=n):e=n),e<=0?()=>F.E:(0,E.e)((t,i)=>{let a,r=0;const x=()=>{if(a?.unsubscribe(),a=null,null!=s){const u="number"==typeof s?b(s):(0,V.Xf)(s(r)),L=(0,S.x)(i,()=>{L.unsubscribe(),c()});u.subscribe(L)}else c()},c=()=>{let u=!1;a=t.subscribe((0,S.x)(i,void 0,()=>{++r<e?a?x():u=!0:i.complete()})),u&&x()};c()})}({delay:()=>this.startTimer}))}constructor(t,i){this.summaryService=t,this.router=i,this.randomizer=!1,this.maxRep=-1,this.initialRep=-1,this.examMode=!1,this.sectionsVisible=!1,this.questionCards=[],this.currentIndex=-1,this.currentCard=null,this.learningInProgress=!1,this.questions=[],this.learningSummary$=new y.X(null),this.nextCard$=new y.X(null),this.progress$=new y.X(null),this.stopTimer=new w.x,this.startTimer=new w.x}resetToDefault(){this.randomizer=!1,this.maxRep=-1,this.initialRep=-1,this.examMode=!1,this.sectionsVisible=!1,this.questionCards=[],this.currentIndex=-1,this.currentCard=null,this.learningInProgress=!1,this.learningSummary$.next(null),this.nextCard$.next(null),this.progress$.next(null)}stopLearning(){this.summaryService.addSummary(this.repetitionModeActive),this.stopTimer.next(),this.resetToDefault(),this.router.navigateByUrl("/learning/summary")}setLearningFlowData(t){const{randomizer:i,maxRep:r,initialRep:a,examMode:x,sectionsVisible:c,questions:u}=t;this.questions=u,this.randomizer=i,this.maxRep=r,this.initialRep=a,this.examMode=x,this.sectionsVisible=c,this.initQuestionCards(u)}isDataFlowEmpty(){return 0===this.questionCards.length||null===this.currentCard}restart(){this.initQuestionCards(this.questions)}initQuestionCards(t){let i=t.flatMap(r=>r.subQuestions.map(a=>({id:r.id,mainHeading:r.heading,subHeading:a.heading,sections:a.sections,repLeft:this.initialRep,wrongAns:!1,sectionsVisible:this.sectionsVisible})));this.randomizer&&this.shuffle(i),this.questionCards=i,this.startLearning()}startLearning(){this.summaryService.addTotalQuestions(this.questionCards.length),this.currentIndex=0,this.currentCard=this.questionCards[this.currentIndex],this.nextCard$.next(this.currentCard),this.progress$.next({total:this.questionCards.length,left:this.questionCards.filter(t=>0!==t.repLeft).length}),this.learningInProgress=!0,this.startTimer.next()}nextQuestion(){if(-1!==this.currentIndex)return this.questionCards[this.currentIndex].repLeft--,this.currentIndex=this.findNextIndex(),-1===this.currentIndex?(this.progress$.next({total:this.questionCards.length,left:this.questionCards.filter(t=>0!==t.repLeft).length}),void this.stopLearning()):(this.currentCard=this.questionCards[this.currentIndex],this.nextCard$.next(this.currentCard),void this.progress$.next({total:this.questionCards.length,left:this.questionCards.filter(t=>0!==t.repLeft).length}));this.stopLearning()}previousQuestion(){}next(){this.progress$.next({total:this.questionCards.length,left:this.questionCards.filter(t=>0!==t.repLeft).length}),this.currentIndex=this.findNextIndex(),-1!==this.currentIndex?(this.currentCard=this.questionCards[this.currentIndex],this.nextCard$.next(this.currentCard)):this.stopLearning()}markAsCorrect(){if(this.currentCard&&this.learningInProgress){const{id:t,subHeading:i,mainHeading:r}=this.currentCard,a=t&&i?`${t} ${i}`:r;-1!==this.currentIndex&&this.questionCards[this.currentIndex].repLeft--,0===this.questionCards[this.currentIndex].repLeft&&!this.questionCards[this.currentIndex].wrongAns&&this.summaryService.addNonProblematicQuestion(a)}this.next()}markAsBad(){if(this.currentCard&&this.learningInProgress){const{id:t,subHeading:i,mainHeading:r}=this.currentCard;this.summaryService.addProblematicQuestion(t&&i?`${t} ${i}`:r),this.questionCards[this.currentIndex].wrongAns=!0,this.questionCards[this.currentIndex].repLeft<this.maxRep&&this.questionCards[this.currentIndex].repLeft++}this.next()}findNextIndex(){const t=this.questionCards.map((i,r)=>({idx:r,selectable:0!==i.repLeft})).filter(i=>i.selectable);return 0===t.length?-1:this.currentIndex===this.questionCards.length-1||0===t.filter(i=>i.idx>this.currentIndex).length?t[0].idx:t.filter(i=>i.idx>this.currentIndex)[0].idx}shuffle(t){for(var r,a,i=t.length;--i>0;)a=t[r=Math.floor(Math.random()*(i+1))],t[r]=t[i],t[i]=a}}return(n=e).\u0275fac=function(t){return new(t||n)(C.LFG(N.J),C.LFG(H.F0))},n.\u0275prov=C.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),e})()},7382:(Q,g,o)=>{o.d(g,{J:()=>d});var v=o(5619),p=o(4946);let d=(()=>{var h;class f{constructor(){this.learningTime=null,this.problematicQuestions={},this.nonProblematicQuestions=[],this.totalQuestions=0,this.revisionMode=!1,this.summary$=new v.X(null)}addSummary(l){this.summary$.next({nonProblematic:this.nonProblematicQuestions.length,problematic:this.problematicQuestions,time:this.learningTime,totalQuestions:this.totalQuestions,revisionMode:l})}addLearningTime(l){this.learningTime=l}addTotalQuestions(l){this.totalQuestions=l}addProblematicQuestion(l){l in this.problematicQuestions?this.problematicQuestions[l]++:this.problematicQuestions[l]=1}addNonProblematicQuestion(l){this.nonProblematicQuestions.includes(l)||this.nonProblematicQuestions.push(l)}}return(h=f).\u0275fac=function(l){return new(l||h)},h.\u0275prov=p.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),f})()}}]);